let state={activeStep:0,isDownloadMenuOpen:!1,isMobileMenuOpen:!1,isMobileDownloadOpen:!1,activeFaqItems:new Set,barkDescriptionRequested:!1};const tutorialSteps=[{id:0,hasMedia:!1},{id:1,hasMedia:!0},{id:2,hasMedia:!0},{id:3,hasMedia:!0}],storeUrls={chrome:"https://chromewebstore.google.com/detail/nkafiiklocomjnjdigkojieghpplofcm",firefox:"https://addons.mozilla.org/en-US/firefox/addon/bark-sender/",edge:"https://microsoftedge.microsoft.com/addons/detail/ljjgbgdkhpeimhoianpnleiilmbaaeha"},faqData={en:[{id:"qna-update",question:"How to update Bark Sender?",answer:'You can update Bark Sender directly from the browser extension store. Extensions installed from the store are automatically managed and kept up to date by the browser. You can also go to the extension management page and click "Update" to update manually. For offline updates (e.g., intranet environments), click the "Download" button at the top of the page to get the offline package for your browser; historical versions are also available in the Telegram channel. Offline packages are signed by Google and will auto-update once connected to the internet.'},{id:"qna-troubleshooting",question:"Why am I not receiving push notifications?",answer:"Please check the following: 1) Make sure your KEY and server are accessible; 2) Check if your self-hosted server address is correctly configured; 3) Ensure your device has a stable internet connection; 4) Restart your browser and try again."},{id:"qna-security",question:"How is my data kept secure?",answer:"Bark Sender is open source. The extension does not collect your information or send data to any designated API server. You can enable encryption to secure your data, or self-host a Bark Server for pushing notifications."},{id:"qna-devices",question:"Can I configure multiple devices?",answer:"Yes, you can add multiple devices in the extension settings and assign different aliases. When sending messages, you can choose to push to specific devices or all devices."},{id:"qna-encryption",question:"Why is only CBC mode supported for encryption?",answer:"Currently, only CBC mode is supported. Due to security concerns, ECB mode will not be implemented. GCM has unresolved issues in testing, so it will not be supported in the short term."},{id:"qna-parse",question:"Why can’t some webpages be parsed?",answer:"1. The webpage must be fully loaded first. 2. Some webpages protected by browser vendors cannot have scripts injected."},{id:"qna-params",question:"Why are some parameter settings not taking effect?",answer:"Although parameters provided by Bark’s official extension are implemented, some require a combination to work. For example, volume needs to be paired with specific push levels to take effect."}],zh_hans:[{id:"qna-update",question:"如何更新 Bark Sender？",answer:'你可以通过浏览器扩展商店直接更新 Bark Sender，商店安装的扩展会由浏览器自动管理并保持最新，你也可以进入扩展管理页点击 "更新" 来手动更新。如内网等情况需要离线更新，可点击页面顶部的 "下载" 按钮，选择对应浏览器的离线安装包；也可以在 Telegram 频道获取历史版本的离线包。离线安装包同样经过 Google 签名，支持联网后自动更新。'},{id:"qna-troubleshooting",question:"为什么收不到推送通知？",answer:"请检查以下几点：1) 确保 KEY 以及服务器是否能正常访问；2) 检查自建服务器地址是否正确配置；3) 确保设备网络连接正常；4) 重启浏览器并重新尝试。"},{id:"qna-security",question:"如何保证数据安全？",answer:"Bark Sender 代码开源，扩展不会收集你的信息，不会将数据发送到指定 API 服务器。你可以开启加密, 来确保数据安全，也可以自建 Bark Server 进行推送。"},{id:"qna-devices",question:"可以配置多个设备吗？",answer:"是的，可以在扩展设置中添加多个设备，为每个设备设置不同的别名。发送消息时可以选择推送到指定设备或所有设备。"},{id:"qna-encryption",question:"为什么只支持 CBC 模式加密？",answer:"加密目前仅支持 CBC 模式。由于安全问题，ECB 模式将不会实现，而 GCM 在测试中存在未解决的问题，因此短期内不会支持。"},{id:"qna-parse",question:"为什么有的网页无法解析内容？",answer:"1. 首先网页需要加载完毕。2. 有些受浏览器厂商保护的网页无法注入脚本。"},{id:"qna-params",question:"为什么有些参数配置不生效？",answer:"尽管 Bark 官方提供的参数扩展都进行了实现，但是有些参数是需要组合才能生效, 例如音量需要配合特定推送级别才能生效。"}],zh_hant:[{id:"qna-update",question:"如何更新 Bark Sender？",answer:"你可以透過瀏覽器擴充功能商店直接更新 Bark Sender，從商店安裝的擴充功能會由瀏覽器自動管理並保持最新，你也可以進入擴充功能管理頁點擊「更新」來手動更新。若在內網等情況需要離線更新，可點擊頁面頂部的「下載」按鈕，選擇對應瀏覽器的離線安裝包；也可以在 Telegram 頻道取得歷史版本的離線包。離線安裝包同樣經過 Google 簽章，支援連網後自動更新。"},{id:"qna-troubleshooting",question:"為什麼收不到推播通知？",answer:"請檢查以下幾點：1) 確保 KEY 以及伺服器能正常存取；2) 檢查自建伺服器位址是否正確設定；3) 確保裝置網路連線正常；4) 重新啟動瀏覽器並再試一次。"},{id:"qna-security",question:"如何確保資料安全？",answer:"Bark Sender 原始碼開放，擴充功能不會蒐集你的資訊，也不會將資料傳送到指定的 API 伺服器。你可以開啟加密來確保資料安全，也可以自建 Bark Server 來推播。"},{id:"qna-devices",question:"可以設定多個裝置嗎？",answer:"可以，你可以在擴充功能設定中新增多個裝置，並為每個裝置設定不同的別名。傳送訊息時可以選擇推播到指定裝置或全部裝置。"},{id:"qna-encryption",question:"為什麼只支援 CBC 模式加密？",answer:"目前加密僅支援 CBC 模式。由於安全性問題，ECB 模式不會實作，而 GCM 在測試中仍存在未解決的問題，因此短期內不會支援。"},{id:"qna-parse",question:"為什麼有些網頁無法解析內容？",answer:"1. 網頁必須先完全載入。2. 有些受瀏覽器廠商保護的網頁無法注入 JS 。"},{id:"qna-params",question:"為什麼有些參數設定沒有生效？",answer:"雖然 Bark 官方提供的參數擴充功能都已實作，但有些參數需要搭配才能生效，例如音量需要配合特定推播等級才會生效。"}]};function detectLanguage(){var e=window.location.pathname.split("/").filter(e=>e);if(0<e.length)switch(e[0].toLowerCase()){case"zh_cn":case"zh-cn":return"zh_cn";case"zh_hk":case"zh-hk":return"zh_hk";case"en_us":case"en-us":return"en_us";case"en":return"en"}e=navigator.language||navigator.userLanguage;return e.toLowerCase().includes("zh")?e.toLowerCase().includes("hk")||e.toLowerCase().includes("tw")||e.toLowerCase().includes("mo")?"zh_hk":"zh_cn":e.toLowerCase().startsWith("en")?"en_us":"zh_cn"}function jsonp(r,l="callback",d=1e4){return new Promise((t,e)=>{const n="jsonp_callback_"+Math.round(1e5*Math.random()),o=document.createElement("script"),a=setTimeout(()=>{i(),e(new Error("JSONP请求超时"))},d);function i(){o.parentNode&&o.parentNode.removeChild(o),delete window[n],clearTimeout(a)}window[n]=function(e){i(),t(e)},o.onerror=function(){i(),e(new Error("JSONP请求失败"))};var s=r.includes("?")?"&":"?";o.src=r+s+l+"="+n,document.head.appendChild(o)})}async function fetchBarkDescription(){let e="cn",t="zh_cn";switch(detectLanguage()){case"zh_hk":e="hk",t="zh_hk";break;case"en_us":case"en":e="us",t="en_us";break;default:e="cn",t="zh_cn"}var n=`https://itunes.apple.com/lookup?id=1403753865&country=${e}&lang=`+t;try{var o=await jsonp(n,"callback",8e3);if(o&&o.results&&0<o.results.length){var a=o.results[0].description;if(a)return a}return null}catch(e){return console.error("获取Bark描述失败:",e),null}}async function updateBarkIntro(){var e=document.getElementById("barkIntroContent");if(e)try{var t,n=await fetchBarkDescription();n?(t=n.split("\n").filter(e=>e.trim()).map(e=>`<p class="mb-3">${e.trim()}</p>`).join(""),e.innerHTML=t):console.debug("使用默认的Bark描述内容")}catch(e){console.error("更新Bark介绍时出错:",e)}}function openLink(e){window.open(e,"_blank")}function scrollToSection(e){e=document.getElementById(e);e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),state.isMobileMenuOpen)&&toggleMobileMenu()}function openStore(e){e=storeUrls[e];e&&openLink(e)}function downloadFile(e){switch(e){case"edge":openLink("https://chromewebstore.google.com/detail/nkafiiklocomjnjdigkojieghpplofcm");break;case"firefox":openLink("https://addons.mozilla.org/en-US/firefox/addon/bark-sender/");break;default:openLink("https://chromewebstore.google.com/detail/nkafiiklocomjnjdigkojieghpplofcm")}}function toggleDownloadMenu(){var e=document.getElementById("downloadMenu"),t=document.getElementById("downloadBtn"),n=t.querySelector("svg");state.isDownloadMenuOpen?(e.classList.add("hidden"),t.classList.remove("bg-white/10","text-white"),n.style.transform="rotate(0deg)",state.isDownloadMenuOpen=!1):(e.classList.remove("hidden"),t.classList.add("bg-white/10","text-white"),n.style.transform="rotate(180deg)",state.isDownloadMenuOpen=!0)}function toggleMobileMenu(){var e=document.getElementById("mobileMenu"),t=document.getElementById("mobileMenuBtn").querySelector("svg path");state.isMobileMenuOpen?(e.classList.add("hidden"),t.setAttribute("d","M4 6h16M4 12h16M4 18h16"),state.isMobileMenuOpen=!1):(e.classList.remove("hidden"),t.setAttribute("d","M6 18L18 6M6 6l12 12"),state.isMobileMenuOpen=!0)}function toggleMobileDownload(){const e=document.getElementById("mobileDownloadContent");const t=event.currentTarget.querySelector("svg");var n=[document.getElementById("mobileMenuIntro"),document.getElementById("mobileMenuTutorial"),document.getElementById("mobileMenuFaq"),document.getElementById("mobileMenuTelegram"),document.getElementById("mobileMenuGithub")];state.isMobileDownloadOpen?(e.classList.add("hidden"),t.style.transform="rotate(0deg)",n.forEach((e,t)=>{setTimeout(()=>{e.style.opacity="1",e.style.transform="translateY(0)",e.style.maxHeight="60px",e.style.paddingTop="0.5rem",e.style.paddingBottom="0.5rem",e.style.marginBottom="",e.style.overflow="visible"},50*t)}),state.isMobileDownloadOpen=!1):(n.forEach((e,t)=>{setTimeout(()=>{e.style.opacity="0",e.style.transform="translateY(-10px)",e.style.maxHeight="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginBottom="0",e.style.overflow="hidden"},30*t)}),setTimeout(()=>{e.classList.remove("hidden"),t.style.transform="rotate(180deg)"},150),state.isMobileDownloadOpen=!0)}function setActiveStep(e){state.activeStep=e;var t=tutorialSteps[e],n=document.querySelector("#tutorialContent .media-container");n&&t&&(document.querySelectorAll(".step-media").forEach(e=>e.classList.add("hidden")),t.hasMedia?(t=document.getElementById(`step-${e}-media`))&&(t.classList.remove("hidden"),n.style.display="block"):n.style.display="none");document.querySelectorAll(".step-content").forEach(e=>e.classList.add("hidden"));t=document.getElementById(`step-${e}-content`);t&&t.classList.remove("hidden"),updateStepButtons()}function updateStepButtons(){document.querySelectorAll("#tutorialSteps button").forEach((e,t)=>{var t=t===state.activeStep,n=e.querySelector(".step-circle"),o=e.querySelector(".step-title"),a=e.querySelector(".step-description");t?(e.className="w-full text-left py-4 px-2 border-l-2 transition-all duration-300 border-l-blue-400 bg-blue-500/5",n&&(n.className="step-circle w-8 h-8 rounded-full flex items-center justify-center font-medium text-sm bg-blue-500 text-white"),o&&(o.className="step-title text-base font-medium mb-1 text-white"),a&&(a.className="step-description text-sm text-gray-400")):(e.className="w-full text-left py-4 px-2 border-l-2 transition-all duration-300 border-l-transparent hover:border-l-gray-500 hover:bg-white/5",n&&(n.className="step-circle w-8 h-8 rounded-full flex items-center justify-center font-medium text-sm bg-gray-700 text-gray-300"),o&&(o.className="step-title text-base font-medium mb-1 text-gray-300"),a&&(a.className="step-description text-sm text-gray-500"))})}function setActiveStepWithAnimation(e){if(e!==state.activeStep){const t=document.getElementById("tutorialContent");t.style.opacity="0.5",t.style.transform="translateY(10px)",setTimeout(()=>{setActiveStep(e),updateTutorialTabs(),t.style.opacity="1",t.style.transform="translateY(0)"},150)}}function updateTutorialTabs(){document.querySelectorAll(".tutorial-tab").forEach((e,t)=>{t=t===state.activeStep;e.className=t?"tutorial-tab flex-1 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-300 bg-white text-gray-900":"tutorial-tab flex-1 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-300 text-gray-300 hover:text-white hover:bg-white/10"})}function initAnimations(){const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&("introTitle"===(e=e.target).id&&gsap.fromTo(e,{y:40,opacity:0,scale:.8},{y:0,opacity:1,scale:1,duration:.6,ease:"back.out(2.0)"}),"flowDiagram"===e.id&&gsap.fromTo(e,{y:60,opacity:0,scale:.9},{y:0,opacity:1,scale:1,duration:.8,ease:"back.out(1.7)"}),"componentInfoContainer"===e.id&&gsap.fromTo(e,{y:40,opacity:0},{y:0,opacity:1,duration:.5,ease:"power2.out"}),"tutorialTitle"===e.id&&gsap.fromTo(e,{y:40,opacity:0,scale:.8},{y:0,opacity:1,scale:1,duration:.6,ease:"back.out(2.0)"}),"tutorialContent"===e.id&&gsap.fromTo(e,{x:-60,opacity:0,scale:.9},{x:0,opacity:1,scale:1,duration:.5,ease:"back.out(1.7)"}),"tutorialSteps"===e.id&&gsap.fromTo(e,{x:60,opacity:0,scale:.9},{x:0,opacity:1,scale:1,duration:.5,delay:.1,ease:"back.out(1.7)"}),e.matches("#faq .text-center")&&gsap.fromTo(e,{y:40,opacity:0,scale:.8},{y:0,opacity:1,scale:1,duration:.4,ease:"back.out(2.0)"}),e.classList.contains("faq-item")&&gsap.fromTo(e,{y:25,opacity:0,scale:.95},{y:0,opacity:1,scale:1,duration:.35,ease:"back.out(1.5)"}),t.unobserve(e))})},{root:null,rootMargin:"-25% 0px -25% 0px",threshold:.1});["#introTitle","#flowDiagram","#componentInfoContainer","#tutorialTitle","#tutorialContent","#tutorialSteps","#faq .text-center",".faq-item"].forEach(e=>{document.querySelectorAll(e).forEach(e=>{e&&t.observe(e)})}),state.intersectionObserver=t}function initNavbarLogoAnimation(){var e,t=document.getElementById("heroTitle");const n=document.getElementById("navbarLogo");t&&n&&((e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?gsap.to(n,{opacity:0,y:-10,duration:.3,ease:"back.in(1.7)"}):(gsap.to(n,{opacity:1,y:0,duration:.5,ease:"back.out(1.7)"}),state.barkDescriptionRequested||(state.barkDescriptionRequested=!0,console.log("主标题不可见，开始异步获取Bark描述"),updateBarkIntro()))})},{root:null,rootMargin:"0px",threshold:.1})).observe(t),state.titleObserver=e)}function handleClickOutside(e){var t=document.getElementById("downloadMenu"),n=document.getElementById("downloadBtn"),o=document.getElementById("mobileMenu"),a=document.getElementById("mobileMenuBtn");!state.isDownloadMenuOpen||t.contains(e.target)||n.contains(e.target)||toggleDownloadMenu(),!state.isMobileMenuOpen||o.contains(e.target)||a.contains(e.target)||toggleMobileMenu()}function handleEscapeKey(e){"Escape"===e.key&&(state.isDownloadMenuOpen&&toggleDownloadMenu(),state.isMobileMenuOpen)&&toggleMobileMenu()}function renderFAQ(){var t=document.getElementById("faqContainer");if(t){let e=window.location.pathname.split("/")[1];switch(e){case"zh_hans":case"zh_hant":case"en":break;default:e="en"}var n=faqData[e]||faqData.en;t.innerHTML=n.map((e,t)=>` <div class="faq-item border-b border-white/10 last:border-b-0 transition-all duration-300"> <button onclick="toggleFaqItem('${e.id}')" class="w-full py-3 px-5 text-left flex items-center justify-between hover:bg-white/5 transition-colors duration-200" aria-expanded="false" aria-controls="faq-content-${e.id}" > <h3 class="text-base font-medium text-white pr-4">${e.question}</h3> <svg class="faq-icon w-5 h-5 text-gray-400 transition-transform duration-300 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" > <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path> </svg> </button> <div id="faq-content-${e.id}" class="faq-content overflow-hidden transition-all duration-300 max-h-0" aria-hidden="true" > <div class="pt-5 pb-6 px-5"> <p class="text-gray-400 text-sm leading-relaxed">${e.answer}</p> </div> </div> </div> `).join("")}else console.debug("faqContainer 元素不存在，跳过FAQ渲染")}function toggleFaqItem(e){var t=document.getElementById("faq-content-"+e),n=t.previousElementSibling,o=n.querySelector(".faq-icon");state.activeFaqItems.has(e)?(t.style.maxHeight="0",t.setAttribute("aria-hidden","true"),n.setAttribute("aria-expanded","false"),o.style.transform="rotate(0deg)",state.activeFaqItems.delete(e)):(t.style.maxHeight=t.scrollHeight+"px",t.setAttribute("aria-hidden","false"),n.setAttribute("aria-expanded","true"),o.style.transform="rotate(180deg)",state.activeFaqItems.add(e))}function toggleBarkIntro(e){var t=document.getElementById("barkIntroContent"),n=document.getElementById("barkIntroExpanded"),o=document.getElementById("barkIntroExpandBtn"),a=document.getElementById("barkIntroCollapseBtn");t&&n&&o&&a&&(e?(n.classList.remove("hidden"),t.classList.remove("max-h-32","overflow-hidden"),t.classList.add("max-h-full"),o.classList.add("hidden"),a.classList.remove("hidden")):(n.classList.add("hidden"),t.classList.remove("max-h-full"),t.classList.add("max-h-32","overflow-hidden"),o.classList.remove("hidden"),a.classList.add("hidden"),scrollToSection("tutorial")))}function initMobileMenuButtons(){[document.getElementById("mobileMenuIntro"),document.getElementById("mobileMenuTutorial"),document.getElementById("mobileMenuFaq"),document.getElementById("mobileMenuTelegram"),document.getElementById("mobileMenuGithub")].forEach(e=>{e&&(e.style.transition="all 0.3s ease",e.style.opacity="1",e.style.transform="translateY(0)",e.style.maxHeight="60px",e.style.paddingTop="0.5rem",e.style.paddingBottom="0.5rem",e.style.overflow="visible")})}function initGradientOrbs(){const n=document.querySelectorAll(".gradient-orb");n.forEach((e,t)=>{setInterval(()=>{checkOrbInteractions(e,n,t)},500)})}function checkOrbInteractions(e,t,a){var n=e.getBoundingClientRect();const i={x:n.left+n.width/2,y:n.top+n.height/2};let s=!1;t.forEach((e,t)=>{if(a!==t){t=e.getBoundingClientRect();const n=t.left+t.width/2,o=t.top+t.height/2;Math.sqrt(Math.pow(i.x-n,2)+Math.pow(i.y-o,2))<300&&(s=!0)}}),s?e.classList.add("attract-blend"):e.classList.remove("attract-blend")}function initApp(){setActiveStep(0),renderFAQ(),initMobileMenuButtons(),initGradientOrbs(),initHeroButtonEffects(),initFlowComponents(),initModalEvents(),initNavbarLogoAnimation(),setTimeout(()=>{initAnimations(),setupPerformanceOptimizations(),updateNavigationBackground()},100),document.addEventListener("mousedown",handleClickOutside),document.addEventListener("keydown",handleEscapeKey),gsap.config({nullTargetWarn:!1}),console.debug("Bark Sender 网站已加载完成")}function setupPerformanceOptimizations(){document.addEventListener("visibilitychange",()=>{document.hidden?gsap.globalTimeline.pause():gsap.globalTimeline.resume()});let e;window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{console.debug("窗口大小已改变")},250)});let t;window.addEventListener("scroll",()=>{updateNavigationBackground(),clearTimeout(t),t=setTimeout(()=>{},16)},{passive:!0})}function updateNavigationBackground(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,t=document.getElementById("menu-bg");t&&(e=Math.min(e/300,1),t.style.opacity=e)}function initHeroButtonEffects(){document.querySelectorAll(".hero-button").forEach(o=>{const a=o.querySelector(".mouse-follower");a&&(o.addEventListener("mouseenter",()=>{a.style.opacity="1"}),o.addEventListener("mouseleave",()=>{a.style.opacity="0"}),o.addEventListener("mousemove",e=>{var t=o.getBoundingClientRect(),n=e.clientX-t.left-6,e=e.clientY-t.top-6;gsap.to(a,{x:n,y:e,duration:.3,ease:"power2.out"})}))})}function initFlowComponents(){document.querySelectorAll("[data-component]").forEach(t=>{const n=t.dataset.component;if(t.addEventListener("click",()=>{window.innerWidth<768&&showComponentInfo(n)}),768<=window.innerWidth){let e;t.addEventListener("mouseenter",()=>{e=setTimeout(()=>{showComponentInfo(n,!0)},200)}),t.addEventListener("mouseleave",()=>{clearTimeout(e)})}});["sender-component-mobile","server-component-mobile","apns-component-mobile","receiver-component-mobile"].forEach((e,t)=>{e=document.getElementById(e);if(e){const n=["sender-component","server-component","apns-component","receiver-component"][t];e.addEventListener("click",()=>showComponentInfo(n))}}),768<=window.innerWidth&&setTimeout(()=>{showComponentInfo("sender-component",!0,!0)},1e3)}function showComponentInfo(e,t=!1,n=!1){window.innerWidth<768?showMobileModal(e):showDesktopInfo(e,t,n),highlightComponent(e)}function showMobileModal(e){var t,n=document.getElementById("componentModal");n&&(e=extractDesktopComponentInfo(e))&&((t=n.querySelector("div > div"))&&(t.innerHTML=generateMobileModalContent(e)),n.classList.remove("hidden"),gsap.fromTo(n.querySelector("div"),{opacity:0,scale:.8,y:20},{opacity:1,scale:1,y:0,duration:.3,ease:"back.out(1.7)"}))}function extractDesktopComponentInfo(e){var t,e={"sender-component":"sender-info","server-component":"server-info","apns-component":"apns-info","receiver-component":"receiver-info"}[e];return(e=e&&document.getElementById(e))?{iconPath:(t=e.querySelector("svg path"))?t.getAttribute("d"):"",colorClass:(t=e.querySelector(".w-16.h-16"))?t.className.match(/bg-(\w+-\d+)/)?.[0]:"bg-blue-500",title:e.querySelector("h4")?.textContent||"",description:e.querySelector("p")?.textContent||"",features:Array.from(e.querySelectorAll(".flex.items-start .text-sm")).map(e=>e.textContent.trim()).filter(e=>e)}:null}function generateMobileModalContent(e){var t=e.features.map(e=>` <li class="flex items-start text-sm text-gray-300"> <svg class="w-4 h-4 text-green-400 mr-3 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path> </svg> ${e}</li> `).join("");return` <div class="p-6"> <div class="text-center mb-6"> <div class="w-16 h-16 ${e.colorClass}rounded-lg flex items-center justify-center mx-auto mb-4"> <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${e.iconPath}"></path> </svg> </div> <h4 class="text-xl font-semibold text-white mb-3">${e.title}</h4> <p class="text-gray-300 text-sm leading-relaxed">${e.description}</p> </div> <ul class="space-y-3"> ${t}</ul> </div> <div class="border-t border-white/10 p-4"> <button id="closeModalBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200"> 关闭 </button> </div>`}function highlightComponent(e){document.querySelectorAll(".flow-component").forEach(e=>{e.classList.remove("active")});var t=document.getElementById(e),e=document.getElementById(e+"-mobile");t&&t.classList.add("active"),e&&e.classList.add("active")}function showDesktopInfo(e,t=!1,n=!1){e={"sender-component":"sender-info","server-component":"server-info","apns-component":"apns-info","receiver-component":"receiver-info"}[e];if(e){document.querySelectorAll(".component-info").forEach(e=>{e.classList.add("hidden"),e.classList.remove("opacity-100"),e.classList.add("opacity-0"),e.classList.remove("translate-y-0"),e.classList.add("translate-y-4")});const o=document.getElementById(e);if(o&&(o.classList.remove("hidden"),setTimeout(()=>{o.classList.remove("opacity-0","translate-y-4"),o.classList.add("opacity-100","translate-y-0")},10),!n)){const a={behavior:t?"auto":"smooth",block:"nearest"};t?setTimeout(()=>{o.scrollIntoView(a)},100):setTimeout(()=>{o.scrollIntoView(a)},300)}}}function closeModal(){const e=document.getElementById("componentModal");e&&gsap.to(e.querySelector("div"),{opacity:0,scale:.9,y:-10,duration:.2,ease:"power2.in",onComplete:()=>{e.classList.add("hidden")}})}function initModalEvents(){const t=document.getElementById("componentModal");t&&(t.addEventListener("click",e=>{("closeModalBtn"===e.target.id||e.target===t)&&closeModal()}),document.addEventListener("keydown",e=>{"Escape"!==e.key||t.classList.contains("hidden")||closeModal()}))}function toggleLanguageMenu(e,t){e=document.getElementById(e),t=document.getElementById(t);e&&t&&(e.classList.contains("hidden")?(e.classList.remove("hidden"),t.style.transform="rotate(180deg)"):(e.classList.add("hidden"),t.style.transform="rotate(0deg)"))}function selectLanguage(e,t,n){e&&(t=document.getElementById(t),n=document.getElementById(n),t&&t.classList.add("hidden"),n&&(n.style.transform="rotate(0deg)"),history.replaceState(null,"","/"+e),window.location.reload())}function switchLanguage(e){selectLanguage(e)}document.addEventListener("DOMContentLoaded",initApp),window.addEventListener("beforeunload",()=>{state.intersectionObserver&&state.intersectionObserver.disconnect(),state.titleObserver&&state.titleObserver.disconnect(),gsap.killTweensOf("*")}),document.addEventListener("click",function(e){var t=document.getElementById("languageBtn"),n=document.getElementById("languageMenu"),o=document.getElementById("languageMenuArrow"),a=document.getElementById("mobileLanguageBtn"),i=document.getElementById("mobileLanguageMenu"),s=document.getElementById("mobileLanguageMenuArrow");t&&n&&o&&!t.contains(e.target)&&!n.contains(e.target)&&(n.classList.add("hidden"),o.style.transform="rotate(0deg)"),a&&i&&s&&!a.contains(e.target)&&!i.contains(e.target)&&(i.classList.add("hidden"),s.style.transform="rotate(0deg)")});